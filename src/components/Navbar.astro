---
const links = [
  { label: "Home", target: "home" },
  { label: "Coaching Program", target: "coaching" },
  { label: "Web Design", target: "web" },
  { label: "About", target: "about" },
];

const cta = { label: "Free Consultation", target: "contact" };
---

<header
  class="fixed top-0 left-0 right-0 z-50 border-b border-white/10 bg-zinc-950/60 backdrop-blur supports-[backdrop-filter]:bg-zinc-950/50"
>
  <div class="mx-auto flex h-16 max-w-6xl items-center justify-between px-4">
    <!-- Logo -->
    <button
      type="button"
      data-nav
      data-target="home"
      data-nav-logo="true"
      class="flex items-center gap-3"
      aria-label="Go to Home"
    >
      <img
        src="/images/elevate.PNG"
        alt="Elevate your Divine logo"
        class="nav-logo h-28 w-auto max-w-[220px] object-contain translate-y-2 transition-all duration-200"
        loading="eager"
      />
    </button>

    <!-- Desktop nav (shows when there's space) -->
    <nav class="hidden items-center gap-3 lg:flex">
      {
        links.map((l) => (
          <button
            type="button"
            data-nav
            data-target={l.target}
            class="btn-ghost"
          >
            {l.label}
          </button>
        ))
      }

      <button type="button" data-nav data-target={cta.target} class="btn-solid">
        {cta.label}
      </button>
    </nav>

    <!-- Mobile/Collapsed nav -->
    <div class="lg:hidden">
      <button
        id="navMenuBtn"
        type="button"
        class="inline-flex items-center justify-center rounded-xl border border-white/20 bg-white/5 p-2 text-white hover:bg-white/10 transition focus:outline-none focus:ring-2 focus:ring-white/30"
        aria-label="Open menu"
        aria-expanded="false"
        aria-controls="navMenuPanel"
      >
        <!-- Hamburger icon -->
        <svg
          class="h-6 w-6"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          aria-hidden="true"
        >
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>

      <!-- Dropdown panel -->
      <div
        id="navMenuPanel"
        class="pointer-events-none absolute right-4 top-16 mt-2 w-[min(92vw,360px)] origin-top-right scale-95 opacity-0 transition duration-150"
        role="dialog"
        aria-label="Navigation menu"
      >
        <div
          class="rounded-2xl border border-white/15 bg-zinc-950/95 backdrop-blur p-3 shadow-lg shadow-black/30"
        >
          <div class="grid gap-2">
            {
              links.map((l) => (
                <button
                  type="button"
                  data-nav
                  data-target={l.target}
                  class="w-full rounded-xl border border-white/15 bg-white/5 px-4 py-3 text-left text-sm font-semibold text-white hover:bg-white/10 transition focus:outline-none focus:ring-2 focus:ring-white/30"
                >
                  {l.label}
                </button>
              ))
            }

            <button
              type="button"
              data-nav
              data-target={cta.target}
              class="w-full rounded-xl bg-white px-4 py-3 text-left text-sm font-semibold text-slate-900 hover:bg-zinc-200 transition focus:outline-none focus:ring-2 focus:ring-white/30"
            >
              {cta.label}
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script is:inline>
    (function () {
      const btn = document.getElementById("navMenuBtn");
      const panel = document.getElementById("navMenuPanel");
      if (!btn || !panel) return;

      const open = () => {
        btn.setAttribute("aria-expanded", "true");
        panel.classList.remove("pointer-events-none", "opacity-0", "scale-95");
        panel.classList.add("pointer-events-auto", "opacity-100", "scale-100");
      };

      const close = () => {
        btn.setAttribute("aria-expanded", "false");
        panel.classList.add("pointer-events-none", "opacity-0", "scale-95");
        panel.classList.remove(
          "pointer-events-auto",
          "opacity-100",
          "scale-100",
        );
      };

      const isOpen = () => btn.getAttribute("aria-expanded") === "true";

      btn.addEventListener("click", (e) => {
        e.stopPropagation();
        isOpen() ? close() : open();
      });

      // Close when clicking outside
      document.addEventListener("click", (e) => {
        if (!isOpen()) return;
        const t = e.target;
        if (t && (panel.contains(t) || btn.contains(t))) return;
        close();
      });

      // Close on Escape
      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") close();
      });

      // Close when selecting a nav item (so menu collapses after navigation)
      panel.addEventListener("click", (e) => {
        const navBtn = e.target.closest("[data-nav]");
        if (!navBtn) return;
        close();
      });

      // If viewport grows to desktop, ensure panel is closed
      const mq = window.matchMedia("(min-width: 1024px)"); // lg breakpoint
      mq.addEventListener("change", (ev) => {
        if (ev.matches) close();
      });
    })();
  </script>

  <!-- Commented out logo responsiveness -->
  <!--  <style>
    /* Shrink logo when nav collapses (below lg) */
    @media (max-width: 1023px) {
      .nav-logo {
        height: 4.75rem; /* ~76px */
        max-width: 220px; /* keep the same max as desktop */
        transform: translateY(0);
      }
    }
  </style> -->
</header>
